<!DOCTYPE html>
<html lang="ko" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flash Cards - Learning App</title>

  <!-- Google Fonts: Inter + Material Symbols -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#13b499",
            "primary-hover": "#16cbb0",
            "background-dark": "#11211e",
            "background-light": "#f6f8f8",
            "card-dark": "#1a2c29",
            "card-hover": "#1e3430",
            "surface": "#244741",
            "surface-hover": "#2f5a52",
            "text-muted": "#93c8bf",
            "text-subtle": "#5d7f79",
            "coral": "#fb7185",
            "border-dark": "#244741",
            "border-hover": "#34655d",
          },
          fontFamily: {
            "display": ["Inter", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "2xl": "1rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>

  <style>
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #11211e;
    }
    ::-webkit-scrollbar-thumb {
      background: #244741;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #2f5a52;
    }

    /* Card flip animation */
    .card-container {
      perspective: 1000px;
    }
    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s ease-in-out;
      transform-style: preserve-3d;
    }
    .card-inner.flipped {
      transform: rotateY(180deg);
    }
    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }
    .card-back {
      transform: rotateY(180deg);
    }

    /* Animated Gradient Border Effect */
    .gradient-border-wrapper {
      position: relative;
      background: linear-gradient(60deg, rgba(19, 180, 153, 0.1), rgba(19, 180, 153, 0.4), rgba(19, 180, 153, 0.1));
      background-size: 200% 200%;
      animation: shimmer 3s linear infinite;
    }
    @keyframes shimmer {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    /* Progress bar glow */
    .progress-glow {
      box-shadow: 0 0 10px rgba(19, 180, 153, 0.6);
    }

    /* Button glow on hover */
    .btn-primary-glow:hover {
      box-shadow: 0 0 20px rgba(19, 180, 153, 0.3);
    }

    /* Dot pattern background */
    .dot-pattern {
      background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0);
      background-size: 32px 32px;
    }

    /* Text selection */
    ::selection {
      background: rgba(19, 180, 153, 0.3);
    }

    /* Bounce animation for hint */
    @keyframes bounce-hint {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }
    .bounce-hint {
      animation: bounce-hint 1.5s ease-in-out infinite;
    }

    /* Hover scale for card content */
    .card-content-scale {
      transition: transform 300ms ease;
    }
    .group:hover .card-content-scale {
      transform: scale(1.05);
    }

    /* Reduced motion - accessibility */
    @media (prefers-reduced-motion: reduce) {
      .gradient-border-wrapper {
        animation: none;
      }
      .bounce-hint {
        animation: none;
      }
      .card-content-scale {
        transition: none;
      }
      .card-inner {
        transition: none;
      }
    }
  </style>
</head>
<body class="bg-background-dark font-display text-white min-h-screen selection:bg-primary/30">
  <div class="flex flex-col h-screen">
    <!-- Header -->
    <header class="flex items-center justify-between border-b border-border-dark px-6 py-4 bg-background-dark sticky top-0 z-50">
      <!-- Logo Section -->
      <div class="flex items-center gap-3 min-w-fit">
        <div class="flex items-center justify-center size-9 rounded-lg bg-primary text-background-dark">
          <span class="material-symbols-outlined text-xl">school</span>
        </div>
        <h1 class="text-lg font-bold tracking-tight text-white hidden sm:block">Flash Cards</h1>
      </div>

      <!-- Center Controls: Deck Selector & Search (visible when deck selected) -->
      <div id="headerControls" class="hidden flex-1 max-w-xl px-4 md:px-8 gap-4 justify-center items-center">
        <!-- Deck Selector -->
        <div class="relative hidden md:block min-w-[180px]">
          <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-primary">
            <span class="material-symbols-outlined text-[20px]">folder</span>
          </div>
          <select id="headerDeckSelect" class="block w-full rounded-lg border-0 bg-card-dark py-2.5 pl-10 pr-10 text-white ring-1 ring-inset ring-border-dark hover:ring-border-hover focus:ring-2 focus:ring-primary text-sm cursor-pointer appearance-none transition-all">
            <!-- Options populated by JS -->
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-text-muted">
            <span class="material-symbols-outlined text-[20px]">expand_more</span>
          </div>
        </div>
      </div>

      <!-- Right Section: Actions -->
      <div class="flex items-center gap-3 min-w-fit">
        <!-- Card Count Badge -->
        <div id="headerCardCount" class="hidden lg:flex h-9 items-center justify-center gap-x-2 rounded-lg bg-surface px-3">
          <span class="material-symbols-outlined text-primary text-[18px]">style</span>
          <p id="headerCardCountText" class="text-white text-sm font-medium leading-normal">0 cards</p>
        </div>
        <button id="exportDeckBtn" class="hidden h-9 items-center justify-center gap-x-2 rounded-lg bg-surface hover:bg-surface-hover px-3 transition-colors min-h-[44px]">
          <span class="material-symbols-outlined text-primary text-[18px]">download</span>
          <span class="text-white text-sm font-medium hidden md:inline">Export</span>
        </button>
        <button id="importDeckBtn" class="flex h-9 items-center justify-center gap-x-2 rounded-lg bg-surface hover:bg-surface-hover px-3 transition-colors min-h-[44px]">
          <span class="material-symbols-outlined text-primary text-[18px]">upload</span>
          <span class="text-white text-sm font-medium hidden md:inline">Import</span>
        </button>
        <button class="size-10 rounded-full bg-card-dark flex items-center justify-center text-text-muted hover:bg-surface hover:text-white transition-colors">
          <span class="material-symbols-outlined">settings</span>
        </button>
        <!-- User Avatar -->
        <div class="size-9 rounded-full bg-primary flex items-center justify-center text-background-dark font-bold text-sm cursor-pointer hover:bg-primary-hover transition-colors">
          U
        </div>
      </div>
    </header>

    <!-- Hidden file input for import -->
    <input type="file" id="importFileInput" accept=".json" class="hidden" />

    <!-- Main Container -->
    <div class="flex flex-1 overflow-hidden">
      <!-- Sidebar -->
      <aside class="w-full md:w-1/3 lg:w-1/4 bg-card-dark border-r border-border-dark flex flex-col">
        <!-- Deck List Header -->
        <div class="p-4 border-b border-border-dark">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-base font-semibold text-white flex items-center gap-2">
              <span class="material-symbols-outlined text-primary text-[20px]">folder</span>
              My Decks
            </h2>
          </div>
          <button id="newDeckBtn" class="w-full h-11 bg-primary hover:bg-primary-hover text-background-dark font-bold rounded-xl transition-all btn-primary-glow flex items-center justify-center gap-2 min-h-[44px]">
            <span class="material-symbols-outlined text-[20px]">add</span>
            New Deck
          </button>
        </div>

        <!-- Deck List -->
        <div id="deckList" class="flex-1 overflow-y-auto p-4 space-y-2">
          <!-- Deck items will be rendered here -->
        </div>

        <!-- Selected Deck Actions -->
        <div id="deckActions" class="p-4 border-t border-border-dark hidden">
          <div class="space-y-2">
            <button id="studyBtn" class="w-full h-12 bg-primary hover:bg-primary-hover text-background-dark font-bold rounded-xl transition-all btn-primary-glow flex items-center justify-center gap-2 min-h-[44px]">
              <span class="material-symbols-outlined">play_arrow</span>
              Study Now
            </button>
            <button id="addCardBtn" class="w-full h-11 bg-surface hover:bg-surface-hover text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2 min-h-[44px]">
              <span class="material-symbols-outlined text-[20px]">add_card</span>
              Add Card
            </button>
            <button id="manageDeckBtn" class="w-full h-11 bg-surface hover:bg-surface-hover text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2 min-h-[44px]">
              <span class="material-symbols-outlined text-[20px]">edit</span>
              Manage Deck
            </button>
          </div>
        </div>
      </aside>

      <!-- Main Area -->
      <main class="flex-1 bg-background-dark overflow-y-auto dot-pattern">
        <!-- Welcome View -->
        <div id="welcomeView" class="flex items-center justify-center h-full">
          <div class="text-center text-text-subtle px-4">
            <div class="mb-6">
              <div class="inline-flex items-center justify-center size-20 rounded-2xl bg-card-dark mb-4">
                <span class="material-symbols-outlined text-5xl text-primary">style</span>
              </div>
            </div>
            <p class="text-xl font-medium text-text-muted mb-2">Welcome to Flash Cards</p>
            <p class="text-text-subtle">Press <kbd class="px-2 py-1 rounded bg-surface text-text-muted text-sm font-mono">N</kbd> or click "New Deck" to get started</p>
          </div>
        </div>

        <!-- Deck Management View -->
        <div id="deckManagementView" class="hidden p-6">
          <div class="mb-6">
            <h2 id="deckTitle" class="text-2xl font-bold mb-2 text-white"></h2>
            <p id="deckDescription" class="text-text-muted"></p>
          </div>

          <!-- Search & Filter -->
          <div class="mb-4 flex gap-3">
            <label class="relative flex-1 group">
              <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-text-muted group-focus-within:text-primary transition-colors">
                <span class="material-symbols-outlined text-[20px]">search</span>
              </div>
              <input
                type="text"
                id="cardSearch"
                placeholder="Search cards..."
                class="block w-full rounded-lg border-0 bg-card-dark py-2.5 pl-10 pr-3 text-white placeholder:text-text-subtle ring-1 ring-inset ring-border-dark hover:ring-[#34655d] focus:ring-2 focus:ring-primary text-sm transition-all"
              />
            </label>
            <div class="relative">
              <select id="filterLevel" class="h-full rounded-lg border-0 bg-card-dark py-2.5 pl-4 pr-10 text-white ring-1 ring-inset ring-border-dark hover:ring-border-hover focus:ring-2 focus:ring-primary text-sm cursor-pointer appearance-none transition-all">
                <option value="all">All Levels</option>
                <option value="1">Level 1</option>
                <option value="2">Level 2</option>
                <option value="3">Level 3</option>
                <option value="due">Due Today</option>
              </select>
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-text-muted">
                <span class="material-symbols-outlined text-[20px]">expand_more</span>
              </div>
            </div>
          </div>

          <!-- Card List -->
          <div id="cardList" class="space-y-3">
            <!-- Cards will be rendered here -->
          </div>
        </div>

        <!-- Study Mode View -->
        <div id="studyView" class="hidden h-full flex flex-col items-center justify-center p-4 md:p-8">
          <div class="w-full max-w-2xl">
            <!-- Progress Indicator -->
            <div class="mb-8 flex flex-col items-center gap-1">
              <h2 id="studyDeckName" class="text-text-muted text-xs font-semibold tracking-widest uppercase"></h2>
              <div class="flex items-baseline gap-2">
                <p id="studyProgress" class="text-white text-xl font-bold">Card 0</p>
                <p id="studyTotal" class="text-text-subtle text-base font-medium">of 0</p>
              </div>
            </div>

            <!-- Flashcard -->
            <div class="gradient-border-wrapper p-[2px] rounded-[1.1rem] shadow-2xl shadow-black/40 hover:shadow-primary/10 transition-shadow duration-500 mb-10">
              <div class="card-container w-full aspect-[1.5/1] min-h-[360px] md:min-h-[420px]">
                <div class="card-inner h-full" id="studyCard">
                  <!-- Front -->
                  <div class="card-front h-full bg-card-dark hover:bg-card-hover rounded-2xl flex flex-col items-center justify-center p-8 text-center cursor-pointer transition-colors relative overflow-hidden group">
                    <div class="absolute inset-0 dot-pattern opacity-50"></div>
                    <!-- Star & Audio buttons -->
                    <div class="absolute top-0 left-0 w-full p-6 flex justify-between z-10">
                      <button class="size-10 rounded-full hover:bg-white/5 flex items-center justify-center text-text-subtle hover:text-yellow-400 transition-colors">
                        <span class="material-symbols-outlined">star</span>
                      </button>
                      <button class="size-10 rounded-full hover:bg-white/5 flex items-center justify-center text-text-subtle hover:text-primary transition-colors">
                        <span class="material-symbols-outlined">volume_up</span>
                      </button>
                    </div>
                    <!-- Content -->
                    <div class="flex flex-col items-center gap-6 z-10 card-content-scale">
                      <span class="text-xs font-bold text-primary bg-primary/10 px-3 py-1 rounded-full uppercase tracking-wider">Question</span>
                      <p id="cardFront" class="text-5xl md:text-7xl font-extrabold text-white tracking-tight leading-tight"></p>
                    </div>
                    <!-- Flip Hint -->
                    <div class="absolute bottom-8 flex items-center gap-2 text-text-muted opacity-60 group-hover:opacity-100 transition-opacity duration-300">
                      <span class="material-symbols-outlined text-[20px] bounce-hint">touch_app</span>
                      <span class="text-sm font-medium">Click to flip</span>
                    </div>
                  </div>
                  <!-- Back -->
                  <div class="card-back h-full bg-card-dark hover:bg-card-hover rounded-2xl flex flex-col items-center justify-center p-8 text-center cursor-pointer transition-colors relative overflow-hidden group">
                    <div class="absolute inset-0 dot-pattern opacity-50"></div>
                    <div class="absolute top-0 left-0 w-full p-6 flex justify-between z-10">
                      <button class="size-10 rounded-full hover:bg-white/5 flex items-center justify-center text-text-subtle hover:text-yellow-400 transition-colors">
                        <span class="material-symbols-outlined">star</span>
                      </button>
                      <button class="size-10 rounded-full hover:bg-white/5 flex items-center justify-center text-text-subtle hover:text-primary transition-colors">
                        <span class="material-symbols-outlined">volume_up</span>
                      </button>
                    </div>
                    <div class="flex flex-col items-center gap-6 z-10 card-content-scale">
                      <span class="text-xs font-bold text-primary bg-primary/10 px-3 py-1 rounded-full uppercase tracking-wider">Answer</span>
                      <p id="cardBack" class="text-5xl md:text-7xl font-extrabold text-white tracking-tight leading-tight"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Study Controls -->
            <div id="studyControls" class="flex flex-col items-center gap-6">
              <!-- Main Buttons -->
              <div class="grid grid-cols-4 gap-3 w-full">
                <!-- Previous Button -->
                <button id="prevCardBtn" class="col-span-1 h-14 rounded-xl bg-surface text-white flex items-center justify-center hover:bg-surface-hover transition-colors focus:ring-2 focus:ring-primary/50 outline-none group min-h-[44px]">
                  <span class="material-symbols-outlined group-hover:-translate-x-1 transition-transform">arrow_back</span>
                </button>
                <!-- Show Answer / Review Again Button -->
                <button id="showAnswerBtn" class="col-span-2 h-14 rounded-xl bg-primary text-background-dark font-bold text-base hover:bg-primary-hover btn-primary-glow transition-all flex items-center justify-center gap-2 focus:ring-2 focus:ring-primary/50 outline-none min-h-[44px]">
                  <span class="material-symbols-outlined">flip</span>
                  <span>Flip Card</span>
                </button>
                <button id="reviewAgainBtn" class="hidden col-span-1 h-14 rounded-xl bg-coral/10 border border-coral/20 text-coral font-bold hover:bg-coral hover:text-white transition-all flex items-center justify-center gap-2 focus:ring-2 focus:ring-coral/50 outline-none min-h-[44px]">
                  <span class="material-symbols-outlined">refresh</span>
                </button>
                <button id="knowItBtn" class="hidden col-span-1 h-14 rounded-xl bg-primary text-background-dark font-bold hover:bg-primary-hover btn-primary-glow transition-all flex items-center justify-center gap-2 focus:ring-2 focus:ring-primary/50 outline-none min-h-[44px]">
                  <span class="material-symbols-outlined">check</span>
                </button>
                <!-- Next Button -->
                <button id="nextCardBtn" class="col-span-1 h-14 rounded-xl bg-surface text-white flex items-center justify-center hover:bg-surface-hover transition-colors focus:ring-2 focus:ring-primary/50 outline-none group min-h-[44px]">
                  <span class="material-symbols-outlined group-hover:translate-x-1 transition-transform">arrow_forward</span>
                </button>
              </div>

              <!-- Keyboard Shortcuts Legend -->
              <div class="hidden md:flex items-center gap-8 text-xs text-text-subtle font-medium select-none">
                <div class="flex items-center gap-2">
                  <div class="h-6 min-w-[24px] px-1.5 flex items-center justify-center rounded bg-surface text-text-muted font-mono border border-white/5">Esc</div>
                  <span>Exit</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="h-6 px-2 flex items-center justify-center rounded bg-surface text-text-muted font-mono border border-white/5">Space</div>
                  <span>Flip</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="h-6 min-w-[24px] px-1.5 flex items-center justify-center rounded bg-surface text-text-muted font-mono border border-white/5">&larr;</div>
                  <span>Review</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="h-6 min-w-[24px] px-1.5 flex items-center justify-center rounded bg-surface text-text-muted font-mono border border-white/5">&rarr;</div>
                  <span>Know it</span>
                </div>
              </div>
            </div>

            <!-- Stats -->
            <div id="studyStats" class="mt-8 flex justify-center gap-6 text-sm">
              <div class="flex items-center gap-2 text-primary">
                <span class="material-symbols-outlined text-[18px]">check_circle</span>
                <span id="correctCount" class="font-bold">0</span>
                <span class="text-text-subtle">correct</span>
              </div>
              <div class="flex items-center gap-2 text-coral">
                <span class="material-symbols-outlined text-[18px]">cancel</span>
                <span id="incorrectCount" class="font-bold">0</span>
                <span class="text-text-subtle">review</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Add/Edit Card Form View -->
        <div id="cardFormView" class="hidden p-6 max-w-2xl mx-auto">
          <div class="bg-card-dark rounded-2xl p-6">
            <h3 id="cardFormTitle" class="text-xl font-bold mb-6 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">add_card</span>
              Add New Card
            </h3>
            <form id="cardForm" class="space-y-4">
              <div>
                <label for="cardFrontInput" class="block text-sm font-medium mb-2 text-text-muted">Front (Question/Term)</label>
                <textarea
                  id="cardFrontInput"
                  rows="3"
                  class="w-full bg-background-dark rounded-lg border-0 px-4 py-3 text-white placeholder:text-text-subtle ring-1 ring-inset ring-border-dark hover:ring-border-hover focus:ring-2 focus:ring-primary transition-all resize-none"
                  placeholder="Enter question or term..."
                  required
                ></textarea>
              </div>
              <div>
                <label for="cardBackInput" class="block text-sm font-medium mb-2 text-text-muted">Back (Answer/Definition)</label>
                <textarea
                  id="cardBackInput"
                  rows="3"
                  class="w-full bg-background-dark rounded-lg border-0 px-4 py-3 text-white placeholder:text-text-subtle ring-1 ring-inset ring-border-dark hover:ring-border-hover focus:ring-2 focus:ring-primary transition-all resize-none"
                  placeholder="Enter answer or definition..."
                  required
                ></textarea>
              </div>
              <div class="flex gap-3 pt-2">
                <button type="submit" class="flex-1 h-12 bg-primary hover:bg-primary-hover text-background-dark font-bold rounded-xl transition-all btn-primary-glow flex items-center justify-center gap-2 min-h-[44px]">
                  <span class="material-symbols-outlined">save</span>
                  Save Card
                </button>
                <button type="button" id="cancelCardBtn" class="flex-1 h-12 bg-surface hover:bg-surface-hover text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2 min-h-[44px]">
                  <span class="material-symbols-outlined">close</span>
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Bottom Progress Bar (Study Mode) -->
  <div id="bottomProgressBar" class="hidden fixed bottom-0 left-0 w-full h-1.5 bg-card-dark z-50">
    <div id="progressBar" class="h-full bg-primary progress-glow transition-all duration-500 ease-out" style="width: 0%"></div>
  </div>

  <!-- Modal Overlay -->
  <div id="modalOverlay" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-card-dark rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl border border-border-dark" id="modalContent">
      <!-- Modal content will be injected here -->
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/storage.js"></script>
  <script src="js/decks.js"></script>
  <script src="js/cards.js"></script>
  <script src="js/learning.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
